version: '3.8'

services:
  zookeeper:
    image: zookeeper:3.8.4
    container_name: monitor-zookeeper
    ports:
      - "2181:2181"
    environment:
      - ZOO_MY_ID=1
      - ZOO_SERVERS=server.1=0.0.0.0:2888:3888;2181
      - ZOO_TICK_TIME=2000
      - ZOO_INIT_LIMIT=10
      - ZOO_SYNC_LIMIT=5
      - ZOO_MAX_CLIENT_CNXNS=60
      - ZOO_AUTOPURGE_PURGEINTERVAL=0
      - ZOO_AUTOPURGE_SNAPRETAINCOUNT=3
    volumes:
      - zookeeper-data:/data
      - zookeeper-datalog:/datalog
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "2181"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - monitor-network

volumes:
  zookeeper-data:
    driver: local
  zookeeper-datalog:
    driver: local

networks:
  monitor-network:
    driver: bridge
